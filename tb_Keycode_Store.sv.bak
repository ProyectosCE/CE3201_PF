`timescale 1ns/1ps
module tb_Keycode_Store;

   // ── señales del DUT ───────────────────────────────────────────────
   logic        clk;
   logic [7:0]  key_code;
   logic        data_ready;
   logic [31:0] rd_out;

   // ── parámetros de la RAM ──────────────────────────────────────────
   localparam STORE_ADDR = 32'h0000_0010;   // 0x0010 = palabra 0x4

   // ── instancia del DUT ─────────────────────────────────────────────
   Keycode_Store #(.STORE_ADDR(STORE_ADDR)) dut (
      .clk       (clk),
      .key_code  (key_code),
      .data_ready(data_ready),
      .rd_out    (rd_out)
   );

   // ── reloj 100 MHz (periodo 10 ns) ─────────────────────────────────
   initial clk = 1'b0;
   always  #5  clk = ~clk;

   // ──  monitor de señales ───────────────────────────────────────────
   initial begin
      $display(" time  | key_code | d_ready |    rd_out");
      $monitor("%t |   %h    |    %b    | %h",
                $time, key_code, data_ready, rd_out);
   end

   // ── estímulos principales ─────────────────────────────────────────
   initial begin
      // valores iniciales
      key_code   = 8'd0;
      data_ready = 1'b0;

      // pequeña espera de arrancada
      repeat (5) @(posedge clk);

      // envía tres teclas
      send_key(8'h6B);   // LEFT
      send_key(8'h74);   // RIGHT
      send_key(8'h75);   // UP

      // deja correr un poco y termina
      repeat (10) @(posedge clk);
      $finish;
   end

   // ── tarea de envío: 1 pulso de data_ready ─────────────────────────
   task send_key(input [7:0] code);
      begin
         @(posedge clk);
         key_code   <= code;
         data_ready <= 1'b1;        // pulso de 1 ciclo
         @(posedge clk);
         data_ready <= 1'b0;
      end
   endtask

endmodule
